global_defs {
    enable_script_security
    log_file /var/log/keepalived/keepalived.log
}
vrrp_instance {{ vrrp_instance_name }} {
    state {{ keepalived_state | default('BACKUP') }}
    interface {{ keepalived_interface | default(interface) | default(ansible_default_ipv4.interface) }}
    virtual_router_id {{ keepalived_vrid | default(50) }}
    priority {{ keepalived_priority | default('100') }}
    advert_int 1
    authentication {
        auth_type PASS
        auth_pass 42keepalive
    }
    virtual_ipaddress {
        {{ keepalived_vip }}/{{ keepalived_vip_cidr }}
    }
    vrrp_script chk_nginx {
        script "/etc/keepalived/check_nginx.sh"
        interval 2
        weight -60
    }
    track_script {
        chk_nginx
    }
    log_detail
}
